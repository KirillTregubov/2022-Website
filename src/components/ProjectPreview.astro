---
import { Image } from 'astro:assets'
import { type CollectionEntry } from 'astro:content'

interface Props {
  project: CollectionEntry<'projects'>
}

const { project } = Astro.props
---

<div>
  <div
    class="w-full flex-shrink-0 overflow-clip rounded-xl bg-neutral-800 object-contain"
  >
    <Image
      class="unblur select-none"
      src={`/assets/projects/${project.data.image.url}`}
      alt={project.data.image?.alt || 'Placeholder project image'}
      width={1200}
      height={630}
      onerror="this.src='/placeholder.jpg'; this.onerror=null"
    />
  </div>
  <div class="mt-4 flex flex-wrap items-center gap-x-2.5">
    <div class="flex flex-wrap gap-x-2 gap-y-1.5">
      <h2 class="text-lg font-semibold">{project.data.name}</h2>
      {
        project.data.technologies &&
          project.data.technologies.map((tech) => (
            <h3 class="color-bg-transition whitespace-nowrap rounded bg-neutral-200 px-2 leading-relaxed text-neutral-700 dark:bg-neutral-700 dark:text-neutral-300">
              {tech}
            </h3>
          ))
      }
    </div>
  </div>
  <div class="mt-3">{project.data.description}</div>
  {
    (project.data.source || project.data.demo) && (
      <div class="mt-2 flex select-none items-center gap-2">
        {project.data.source === 'closed' && (
          <button
            disabled
            aria-disabled="true"
            class="flex cursor-not-allowed items-center py-1.5 pr-2 font-medium leading-none disabled:opacity-80"
          >
            {/* <LockClosedIcon class="mr-1.5 h-5 w-5" aria-hidden="true" /> */}
            <div>Closed Source</div>
          </button>
        )}
        {project.data.source && project.data.source !== 'closed' && (
          <a
            href={project.data.source}
            target="_blank"
            rel="noopener noreferrer"
            class="flex items-center rounded-lg border-2 border-neutral-500 px-3 py-1.5 leading-none text-neutral-700 transition-colors hover:border-neutral-700 hover:text-neutral-900 dark:border-neutral-500 dark:text-neutral-300 dark:hover:border-neutral-100 dark:hover:text-neutral-50"
          >
            {/* <CodeBracketIcon class="mr-1.5 h-5 w-5" aria-hidden="true" /> */}
            Source Code
          </a>
        )}
        {project.data.demo && (
          <a
            href={project.data.demo}
            target="_blank"
            rel="noopener noreferrer"
            class="flex items-center rounded-lg border-2 border-neutral-500 px-3 py-1.5 leading-none text-neutral-700 transition-colors hover:border-neutral-700 hover:text-neutral-900 dark:border-neutral-500 dark:text-neutral-300 dark:hover:border-neutral-100 dark:hover:text-neutral-50"
          >
            {/* <LinkIcon class="mr-1.5 h-5 w-5" aria-hidden="true" /> */}
            Demo
          </a>
        )}
      </div>
    )
  }
</div>
